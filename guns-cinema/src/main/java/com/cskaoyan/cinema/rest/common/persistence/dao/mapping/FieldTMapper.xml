<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cskaoyan.cinema.rest.common.persistence.dao.FieldTMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.cskaoyan.cinema.rest.common.persistence.model.FieldT">
        <id column="UUID" property="uuid" />
        <result column="cinema_id" property="cinemaId" />
        <result column="film_id" property="filmId" />
        <result column="begin_time" property="beginTime" />
        <result column="end_time" property="endTime" />
        <result column="hall_id" property="hallId" />
        <result column="hall_name" property="hallName" />
        <result column="price" property="price" />
    </resultMap>

    <select id="selectOneById" resultType="com.cskaoyan.cinema.vo.cinema.FilmInfoVo">
        select film_id as filmId,film_name as filmName,film_language as filmType,
        img_address as imgAddress,film_cats as filmCats,film_length as filmLength
        from mtime_hall_film_info_t
        where film_id = #{filmId}
    </select>
    <select id="selectHallInfo" resultType="com.cskaoyan.cinema.vo.cinema.HallInfoVo">
        select mft.UUID as hallFieldId,mft.hall_name as hallName,mft.price,mhdt.seat_address as seatFile,
        GROUP_CONCAT(mot.seats_ids) as soldSeats
        from mtime_field_t mft
        left join mtime_hall_dict_t mhdt on mhdt.UUID = mft.hall_id
        left join mooc_order_t mot on mot.field_id = mft.UUID
        where mft.UUID = #{fieldId} GROUP BY mft.UUID
    </select>
</mapper>
